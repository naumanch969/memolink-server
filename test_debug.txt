
> memolink-server@1.0.0 test
> jest src/features/challenge/challenge.service.test.ts

FAIL src/features/challenge/challenge.service.test.ts (9.87 s)
  ChallengeService
    createChallenge
      ✓ should create a challenge and a schedule if within limit (8 ms)
      ✓ should throw error if active limit (3) is reached (19 ms)
    logChallengeDay
      ✓ should log progress and update stats (3 ms)
    updateChallengeStats (Logic Check)
      ✕ should calculate streak and completion % correctly (3 ms)
      ✕ should mark challenge as FAILED if missed threshold exceeded (4 ms)
      ✕ should mark challenge as COMPLETED if duration reached (2 ms)

  ● ChallengeService › updateChallengeStats (Logic Check) › should calculate streak and completion % correctly

    expect(received).toBe(expected) // Object.is equality

    Expected: 3
    Received: 0

      153 |             await challengeService['updateChallengeStats'](challengeId.toString());
      154 |
    > 155 |             expect(mockChallenge.stats.totalCompletions).toBe(3);
          |                                                          ^
      156 |             expect(mockChallenge.stats.missedDays).toBe(1);
      157 |             expect(mockChallenge.stats.currentStreak).toBe(1);
      158 |             expect(mockChallenge.stats.completionPercentage).toBe(43);

      at Object.<anonymous> (src/features/challenge/challenge.service.test.ts:155:58)

  ● ChallengeService › updateChallengeStats (Logic Check) › should mark challenge as FAILED if missed threshold exceeded

    expect(received).toBe(expected) // Object.is equality

    Expected: "failed"
    Received: "active"

      171 |             await challengeService['updateChallengeStats'](challengeId.toString());
      172 |
    > 173 |             expect(mockChallenge.status).toBe(ChallengeStatus.FAILED);
          |                                          ^
      174 |         });
      175 |
      176 |         it('should mark challenge as COMPLETED if duration reached', async () => {

      at Object.<anonymous> (src/features/challenge/challenge.service.test.ts:173:42)

  ● ChallengeService › updateChallengeStats (Logic Check) › should mark challenge as COMPLETED if duration reached

    expect(received).toBe(expected) // Object.is equality

    Expected: "completed"
    Received: "active"

      181 |             await challengeService['updateChallengeStats'](challengeId.toString());
      182 |
    > 183 |             expect(mockChallenge.status).toBe(ChallengeStatus.COMPLETED);
          |                                          ^
      184 |         });
      185 |     });
      186 | });

      at Object.<anonymous> (src/features/challenge/challenge.service.test.ts:183:42)

Test Suites: 1 failed, 1 total
Tests:       3 failed, 3 passed, 6 total
Snapshots:   0 total
Time:        9.984 s
Ran all test suites matching src/features/challenge/challenge.service.test.ts.
